(function(t,e){var n="http://test.gztpay.com:10681";var a={vacation:n+"/VacationActivity/vacation/rank"};t.dynsite=n;t.urlconfig=a})(window);/*!
 * index.js version: v1.0.0; author : Wangpq;
 * Date: 2017-09-28T10:00Z
 */
var GztUtil={getYearMonthDate:function(){var t=new Date,e=String(t.getFullYear()),n=t.getMonth()+1,a=t.getDate();n=n<10?"0"+String(n):n;a=a<10?"0"+String(a):a;return String(e)+String(n)+String(a)}};var app={init:function(){this._init();this.render();this.controls()},_init:function(){this.username=getUrlParam("username");this.shareTag=getUrlParam("sh");this.startDate=20171001;this.endDate=20171008},render:function(){FastClick.attach(document.body);var t=lazyload({target:"#lazy",id:"lazy",lazyTime:200,lazyRange:100});this.initBtnRank()},controls:function(){var t=this;document.querySelector("header a.back").addEventListener("click",function(){historyBack()},false);t.windowScroll();if(t.shareTag=="true"){document.querySelector("header .share").style.display="none";document.querySelector(".rank").style.display="none"}else{GztShare._init({params:[{title:"超长假期·宅不宅都有礼",desc:"国庆中秋双节庆，在家出游都有礼，千元大奖等着你",img:dynsite+"/vacationActivity/images/shareIcon.jpg",url:dynsite+"/vacationActivity/html/index.html?sh=true"}],selector:"header .share",two:false})}document.querySelector(".rank .btn").addEventListener("click",function(){t.myRank()},false)},windowScroll:function(){var t=document.querySelector(".yd-bd"),e=document.querySelector(".yd-bd>.head"),n=document.querySelector("header"),a=document.querySelector("header .hd");t.addEventListener("scroll",function(){var r=e.offsetHeight-n.offsetHeight;if(t.scrollTop>r/4){n.classList.add("color");a.innerHTML="超长假期·宅不宅都有礼"}else{n.classList.remove("color");a.innerHTML=""}},false)},initBtnRank:function(){var t=parseInt(GztUtil.getYearMonthDate());if(t>this.endDate){this.requestMyRank()}},myRank:function(){var t=this,e=parseInt(GztUtil.getYearMonthDate());if(e<t.startDate){toast("活动还未开始哦!")}else if(e>=t.startDate&&e<=t.endDate){toast("国庆假期结束之后才可查看哦~!")}},requestMyRank:function(){var t=this,e=document.querySelector(".rank .btn"),n=document.querySelector(".rank .txt");ajax({url:urlconfig.vacation,type:"GET",dataType:"json",data:{username:t.username},beforeSend:function(){e.style.display="none";n.innerHTML="正在获取数据..."},success:function(e,n){var e=JSON.parse(e);t.randerMyRank(e)},fail:function(t){e.style.display="block";n.innerHTML="请求查看我的排名出错啦..."}})},randerMyRank:function(t){document.querySelector(".rank .txt").innerHTML="我的积分为<b>"+(t.integral||0)+"</b>分,排名第<b>"+(t.rank||0)+"</b>"}};app.init();